var canvas,ctx,width,height,CORNER,CENTER,CLOSE,SPACE,LEFT,RIGHT,UP,DOWN,SQUARE,ROUND,PROJECT,MITER,BEVEL,DEGREES,RADIANS,PI,TAU,RGB,HSL,HEX,LEFT_BUTTON,RIGHT_BUTTON,frameCount,frameRate,millis,debug,equal,day,month,year,hour,minute,seconds,enableContextMenu,enableResize,smooth,cursor,angleMode,max,min,mag,dist,exp,norm,map,lerp,random,constrain,log,sqrt,sq,pow,abs,floor,ceil,round,sin,cos,tan,acos,asin,atan,atan2,radians,degrees,fill,stroke,background,color,colorMode,noStroke,noFill,comp,rect,clear,text,rectMode,ellipseMode,createFont,textAlign,textFont,textSize,strokeCap,strokeJoin,strokeWeight,pushMatrix,popMatrix,translate,rotate,scale,beginShape,vertex,curveVertex,bezierVertex,endShape,curve,bezier,arc,ellipse,quad,triangle,point,line,textWidth,textAscent,textDescent,get,mask,image,mousePressed,mouseReleased,mouseScrolled,mouseClicked,mouseOver,mouseOut,mouseMoved,mouseIsPressed,mouseButton,mouseX,mouseY,pmouseX,pmouseY,keyPressed,keyReleased,keyTyped,key,keyIsPressed,keyCode,resetMatrix,bezierPoint,bezierTangent,fps,lerpColor,size,imageMode,arcMode,noLoop,raf,delta,loadImage,then,draw_standin,startMask,resetMask,getImage,shapePathz,set,loadFont,noSmooth,skiJSData,textLeading,pushStyle,popStyle,breakText;ctx=(canvas=document.getElementsByTagName("canvas")[0]??new OffscreenCanvas(window.innerWidth,window.innerHeight)).getContext("2d"),CORNER=0,CENTER=1,CLOSE=!0,SPACE=32,LEFT=37,RIGHT=39,UP=38,DOWN=40,SQUARE="butt",ROUND="round",PROJECT="square",MITER="miter",BEVEL="bevel",DEGREES="deg",RADIANS="rad",TAU=2*(PI=Math.PI),HSL="hsl",HEX="hex",LEFT_BUTTON=0,RIGHT_BUTTON=2,skiJSData={rect:CORNER,ellipse:CENTER,arc:CENTER,image:CORNER,angle:DEGREES,color:RGB="rgb",leading:0,height:12,rate:60,millis:0,start:0,flags:[],fontString(e,t){return(this.flags.includes("bold")?"bold ":"")+(this.flags.includes("italic")?"italic ":"")+`${t}px ${e}`},pos(e,t,a,s,r){return"ellipse"!==e?this[e]<1?[t,a]:[t-s/2,a-r/2]:this[e]<1?[t+s/2,a+s/2]:[t,a]},matrixToArray:e=>["a","b","c","d","e","f"].map(t=>e[t]),matrices:[]},fps=60,shapePathz=[],debug=(...e)=>console.debug(...e),equal=(...e)=>console.assert(...e),day=()=>(new Date).getDate(),month=()=>(new Date).getMonth(),year=()=>(new Date).getYear(),hour=()=>(new Date).getHours(),minute=()=>(new Date).getMinutes(),seconds=()=>(new Date).getSeconds(),enableContextMenu=()=>canvas.oncontextmenu=!0,enableResize=()=>0,cursor=e=>document.body.style.cursor=e,smooth=()=>{ctx.imageSmoothingEnabled=!0,ctx.imageSmoothingQuality="high"},angleMode=e=>skiJSData.angle=e,size=(e,t,a)=>{width=canvas.width=e,height=canvas.height=t,a&&(canvas.style.width=`${e}px`,canvas.style.height=`${t}px`)},noLoop=()=>draw=0,set=(...e)=>{switch(e.length){case 0:return ctx=(canvas=new OffscreenCanvas(width,height)).getContext("2d"),[canvas,ctx];case 1:ctx=(canvas=e[0]).getContext("2d"),width=canvas.width,height=canvas.height;break;case 2:return ctx=(canvas=new OffscreenCanvas(e[0],e[1])).getContext("2d"),width=e[0],height=e[1],[canvas,ctx]}},max=(e,t)=>e<t?t:e,min=(e,t)=>e<t?e:t,mag=(e,t)=>Math.sqrt(e**2+t**2),dist=(e,t,a,s)=>mag(e-a,t-s),exp=e=>Math.E**e,norm=(e,t,a)=>(e-t)/(a-t),map=(e,t,a,s,r)=>s+(r-s)*norm(e,t,a),lerp=(e,t,a)=>(t-e)*a+e,random=(e,t)=>t?Math.random()*(t-e)+e:e?Math.random()*e:Math.random(),constrain=(e,t,a)=>min(max(e,t),a),log=e=>Math.log(e),sqrt=e=>Math.sqrt(e),sq=e=>e**2,pow=(e,t)=>e**t,abs=e=>e<0?-e:e,floor=e=>0|e,ceil=e=>(0|e)+1,round=e=>e-(0|e)<.5?0|e:(0|e)+1,sin=e=>Math.sin("deg"===skiJSData.angle?degrees(e):e),cos=e=>Math.cos("deg"===skiJSData.angle?degrees(e):e),tan=e=>Math.tan("deg"===skiJSData.angle?degrees(e):e),acos=e=>Math.acos("deg"===skiJSData.angle?degrees(e):e),asin=e=>Math.asin("deg"===skiJSData.angle?degrees(e):e),atan=e=>Math.atan("deg"===skiJSData.angle?degrees(e):e),radians=e=>e*(180/PI),degrees=e=>e*(PI/180),atan2=(e,t)=>"deg"===skiJSData.angle?radians(Math.atan2(e,t)):Math.atan2(t,e),bezierPoint=(e,t,a,s,r)=>(1-r)*(1-r)*(1-r)*e+3*(1-r)*(1-r)*r*t+3*(1-r)*r*r*a+r*r*r*s,bezierTangent=(e,t,a,s,r)=>3*r*r*(-e+3*t-3*a+s)+6*r*(e-2*t+a)+3*(-e+t),colorMode=e=>skiJSData.color=e,color=(...e)=>{if("string"==typeof e[0]&&e.length<=1&&/(#|rgb|hsl)/.test(e[0]))return e[0];if(e[0]instanceof Array&&(e=e[0]),"number"==typeof e[1]&&/rgb/.test(e[0])){let t=e[0].match(/\d{1,3}/g);e=[t[0],t[1],t[2],e[1]]}switch(skiJSData.color){case"rgb":let[a,s,r,n]=e.length>4?Object.assign(e,{length:4}):e;switch(e.length){case 1:return`rgba(${a}, ${a}, ${a}, 255)`;case 2:return`rgba(${a}, ${a}, ${a}, ${s/255})`;case 3:return`rgba(${a}, ${s}, ${r}, 255)`;case 4:return`rgba(${a}, ${s}, ${r}, ${n/255})`}break;case"hsl":return`hsl(${e[0]}, ${e[1]}%, ${e[2]}%)`;case"hex":return e[0]}},background=(...e)=>{let t=[ctx.strokeStyle,ctx.fillStyle];ctx.save(),ctx.reset(),ctx.strokeStyle="rgba(0, 0, 0, 0)",ctx.fillStyle=color(...e),ctx.fillRect(0,0,canvas.width,canvas.height),ctx.strokeStyle=t[0],ctx.fillStyle=t[1],ctx.restore()},fill=(...e)=>ctx.fillStyle=color(...e),stroke=(...e)=>ctx.strokeStyle=color(...e),lerpColor=(e,t,a)=>{if("string"!=typeof t||"string"!=typeof e||skiJSData.color!==RGB)return;let[s,r,n,o]=e.match(/\d{1,3}/g),[l,c,g,d]=t.match(/\d{1,3}/g);return`rgba(${lerp(+s,+l,a)}, ${lerp(+r,+c,a)}, ${lerp(+n,+g,a)}, ${lerp(+o,+d,a)})`},clear=()=>{ctx.save(),ctx.reset(),ctx.clearRect(0,0,width,height),ctx.restore()},noStroke=()=>ctx.strokeStyle="rgb(0, 0, 0, 0)",noFill=()=>ctx.fillStyle="rgb(0, 0, 0, 0)",rect=(e,t,a,s,r,n,o,l)=>{if([e,t]=skiJSData.pos("rect",e,t,a,s),r){let c=a/2,g=s/2;r=r>c||r>g?Math.min(c,g):r,n=(n=l?n:r)>c||n>g?Math.min(c,g):n,o=(o=l?o:r)>c||o>g?Math.min(c,g):o,l=(l=l||r)>c||l>g?Math.min(c,g):l,"rgba(0, 0, 0, 0)"===ctx.strokeStyle&&ctx.translate(.5,.5),beginShape(),vertex(e+r,t),vertex(e+a-n,t),curveVertex(e+a,t,e+a,t+n),vertex(e+a,t+s-o),curveVertex(e+a,t+s,e+a-o,t+s),vertex(e+l,t+s),curveVertex(e,t+s,e,t+s-l),vertex(e,t+r),curveVertex(e,t,e+r,t),endShape(),"rgba(0, 0, 0, 0)"===ctx.strokeStyle&&ctx.translate(-.5,-.5)}else ctx.fillRect(e,t,a,s),ctx.strokeRect(e,t,a,s)},clear=()=>ctx.clearRect(0,0,canvas.width,canvas.height),breakText=(e,t)=>{if(!(textWidth(e)>t))return e;{let a=0,s="",r="";for(let n=0;n<e.length;n++)if(textWidth(s+=e[n])>t){a=n+1,s=e.slice(0,a),r=e.slice(a,e.length);break}return r?s+"\n"+breakText(r,t):s}},text=(e,t,a,s,r)=>{e=e.toString(),s&&(e=breakText(e,s)),e.match("\n")?e.split("\n").map((s,r)=>{ctx.fillText(s,t,a+(r-(e.split("\n").length-1)/2)*(skiJSData.height+skiJSData.leading)),ctx.strokeText(s,t,a+(r-(e.split("\n").length-1)/2)*(skiJSData.height+skiJSData.leading))}):(ctx.fillText(e,t,a),ctx.strokeText(e,t,a))},rectMode=e=>skiJSData.rect=e,ellipseMode=e=>skiJSData.ellipse=e,arcMode=e=>skiJSData.arc=e,imageMode=e=>skiJSData.image=e,textAlign=(e,t)=>{ctx.textAlign=e<=0?"start":"center",ctx.textBaseline=t<=0?"hanging":"middle"},createFont=e=>e,textSize=e=>skiJSData.height=e&&(ctx.font=skiJSData.fontString(skiJSData.font,e)),textFont=(e,t=skiJSData.height)=>{skiJSData.height!==t&&(skiJSData.height=t),skiJSData.flags=[],/bold/i.test(e)&&(skiJSData.flags.push("bold"),e=e.replace("bold","")),/italic/i.test(e)&&(skiJSData.flags.push("italic"),e=e.replace("italic","")),e=e.trim(),skiJSData.font=e,ctx.font=skiJSData.fontString(e,t)},textLeading=e=>skiJSData.leading=e,strokeCap=e=>ctx.lineCap=e,strokeJoin=e=>ctx.lineJoin=e,strokeWeight=e=>ctx.lineWidth=e,pushStyle=()=>ctx.save(),popStyle=()=>ctx.restore(),pushMatrix=()=>{let{matrices:e,matrixToArray:t}=skiJSData;e.push(t(ctx.getTransform()))},resetMatrix=popMatrix=()=>ctx.setTransform(DOMMatrix.fromFloat32Array(new Float32Array(skiJSData.matrices.pop()))),translate=(e,t)=>ctx.transform(1,0,0,1,e,t),rotate=e=>{e=degrees(e);let t=Math.cos,a=Math.sin;ctx.transform(t(e),a(e),-a(e),t(e),0,0)},scale=(e,t)=>ctx.transform(e,0,0,t||e,0,0),beginShape=()=>shapePathz=[],vertex=(e,t)=>shapePathz.push({type:"vertex",points:[e,t]}),curveVertex=(e,t,a,s)=>shapePathz.push({type:"curve",points:[e,t,a,s]}),bezierVertex=(e,t,a,s,r,n)=>shapePathz.push({type:"bezier",points:[e,t,a,s,r,n]}),endShape=e=>{let t=shapePathz;t.length<2||"vertex"!==t[0].type||(ctx.beginPath(),t.forEach((e,t)=>ctx[t<1&&"vertex"===e.type?"moveTo":"vertex"===e.type?"lineTo":"curve"===e.type?"quadraticCurveTo":"bezierCurveTo"](...e.points)),e&&ctx.closePath(),ctx.fill(),ctx.stroke())},curve=(...e)=>{if(6!==e.length)return;let[t,a,s,r,n,o]=e;beginShape(),vertex(t,a),curveVertex(s,r,n,o),endShape()},bezier=(...e)=>{if(8!==e.length)return;let[t,a,s,r,n,o,l,c]=e;beginShape(),vertex(t,a),bezierVertex(s,r,n,o,l,c),endShape()},arc=(e,t,a,s,r,n,o=!1)=>{skiJSData.arc&&(e+=a/2,t+=s/2),ctx.save(),ctx.translate(e,t),a!==s&&(a>s?ctx.scale(Math.max(a,s)/Math.min(a,s),1):ctx.scale(1,Math.max(a,s)/Math.min(a,s))),ctx.beginPath(),"rgba(0, 0, 0, 0)"!==ctx.fillStyle&&ctx.moveTo(0,0),ctx.arc(0,0,Math.min(a,s)/2,degrees(r),degrees(n)),o&&ctx.closePath(),ctx.restore(),ctx.fill(),ctx.stroke()},ellipse=(e,t,a,s)=>{ctx.beginPath(),ctx.ellipse(e,t,a/2,s/2,0,0,2*Math.PI),ctx.fill(),ctx.stroke()},quad=(e,t,a,s,r,n,o,l)=>{beginShape(),vertex(e,t),vertex(a,s),vertex(r,n),vertex(o,l),endShape(CLOSE)},triangle=(e,t,a,s,r,n)=>{beginShape(),vertex(e,t),vertex(a,s),vertex(r,n),endShape(CLOSE)},point=(e,t)=>{if("rgba(0, 0, 0, 0)"!==ctx.strokeStyle){let a=[ctx.strokeStyle,ctx.fillStyle];noStroke(),ctx.fillStyle=a[0],ellipse(e,t,ctx.lineWidth,ctx.lineWidth),ctx.strokeStyle=a[0],ctx.fillStyle=a[1]}},line=(e,t,a,s)=>{ctx.beginPath(),ctx.moveTo(e,t),ctx.lineTo(a,s),ctx.closePath(),ctx.stroke()},textWidth=e=>{let t=0;return e.split("\n").map(a=>t=max(t,ctx.measureText(e).width)),t},textAscent=()=>ctx.measureText("a").fontBoundingBoxAscent,textDescent=()=>ctx.measureText("a").fontBoundingBoxDescent,textLeading=e=>skiJSData.leading=e,get=(...e)=>{let[t,a,s,r,n]=e;switch(e.length){case 0:return get(0,0,width,height);case 2:return color((data=ctx.getImageData(t,a,1,1).data)[0],data[1],data[2],data[3]);case 3:let o=new OffscreenCanvas(s.width,s.height),l=o.getContext("2d");return s instanceof HTMLImageElement?(l.drawImage(s,0,0),data=l.getImageData(t,a,1,1)):data=s.getContext("2d").getImageData(t,a,1,1).data,color(data[0],data[1],data[2],data[3]);case 4:let c=new OffscreenCanvas(s,r),g=c.getContext("2d");return g.putImageData(l.getImageData(t,a,s,r),0,0),c;case 5:let o=new OffscreenCanvas(n.width,n.height),l=o.getContext("2d");return l.drawImage(n,-t,-a),o}},mask=()=>ctx.globalCompositeOperation="source-atop",startMask=resetMask=()=>ctx.globalCompositeOperation="source-over",getImage=(e,t,a)=>new Promise((s,r)=>{let n=Object.assign(t?new Image(t,a):new Image,/khanacademy/.test(e)?{src:e}:{src:e,crossOrigin:"anonymous"});n.onload=()=>s(n),n.onerror=()=>r("Invalid or unaccessible image source")}),image=(e,t,a,s=e.width,r=e.height)=>{[t,a]=skiJSData.pos("image",t,a,s,r),ctx[e instanceof ImageData?"putImageData":"drawImage"](e,t,a,s,r)},loadImage=(e,t,a)=>Object.assign(t?new Image(t,a):new Image,/khanacademy/.test(e)?{src:e}:{src:e,crossOrigin:"anonymous"}),loadFont=(...e)=>{let t=Object.assign(document.createElement("link"),{rel:"stylesheet",href:`https://fonts.googleapis.com/css?family=${e.join("|").replace(/ /g,"+")}`});return document.body.appendChild(t),t},mousePressed=()=>{},mouseReleased=()=>{},mouseScrolled=()=>{},mouseClicked=()=>{},mouseOut=()=>{},mouseOver=()=>{},mouseMoved=()=>{},mouseIsPressed=!1,mouseButton=LEFT_BUTTON,mouseY=0,pmouseX=mouseX=0,pmouseY=mouseY,canvas.onmousedown=e=>{mousePressed(e),mouseIsPressed=!0,mouseButton=e.button},canvas.onmousemove=e=>{let t=canvas.getBoundingClientRect();pmouseX=mouseX,pmouseY=mouseY,mouseX=constrain(e.pageX-t.x,0,width),mouseY=constrain(e.pageY-t.y,0,height),mouseMoved(e)},canvas.onmouseup=e=>{mouseReleased(e),mouseClicked(e),mouseButton=e.button,mouseIsPressed=!1,e.preventDefault()},canvas.oncontextmenu=e=>e.preventDefault(),canvas.onmouseover=e=>mouseOver(e),canvas.onmouseout=e=>mouseOut(e),canvas.onwheel=e=>{mouseScrolled(e)},keyPressed=()=>{},keyReleased=()=>{},keyTyped=()=>{},document.onkeydown=e=>{e.target instanceof HTMLBodyElement&&(e.preventDefault(),key=e.key,keyCode=e.keyCode,keyIsPressed=!0,keyPressed(e))},document.onkeyup=e=>{e.target instanceof HTMLBodyElement&&(e.preventDefault(),key=e.key,keyCode=e.keyCode,keyReleased(e))},document.onkeypress=e=>{e.target instanceof HTMLBodyElement&&(e.preventDefault(),key=e.key,keyCode=e.keyCode,keyTyped(e))},frameCount=0,frameRate=e=>skiJSData.rate=e,millis=()=>skiJSData.millis,delta=1e3/60,then=performance.now(),skiJSData.start=performance.now(),raf=e=>{requestAnimationFrame(raf),delta=e-then;let t=1e3/skiJSData.rate;if(delta<t)return;let a=delta%t;then=e-a,delta-=a,draw_standin(e),frameCount+=1,skiJSData.millis=performance.now()-skiJSData.start,fps=1e3/delta},Object.defineProperty(window,"draw",{get:()=>draw_standin,set(e){"function"!=typeof draw_standin&&requestAnimationFrame(raf),draw_standin=e},configurable:!0}),size(window.innerWidth,window.innerHeight);for(let i=requestAnimationFrame(()=>0);i--;)cancelAnimationFrame(i);
